# PostgreSQL Host-Based Authentication for HIPAA Compliance
# Only allow SSL/TLS connections - reject plain text connections

# TYPE  DATABASE        USER            ADDRESS                 METHOD

# Local connections (Unix socket) - allow for maintenance
local   all             all                                     trust

# Reject non-SSL TCP/IP connections
host    all             all             0.0.0.0/0               reject

# Require SSL for all remote connections
hostssl all             all             0.0.0.0/0               scram-sha-256

# IPv6 - reject non-SSL
host    all             all             ::/0                    reject

# IPv6 - require SSL
hostssl all             all             ::/0                    scram-sha-256
